joined_data %>%
  is.na() %>%
  reshape2::melt() %>%
  ggplot(aes(Var2, Var1, fill=value)) + 
  geom_raster() + 
  coord_flip() +
  scale_y_continuous(NULL, expand = c(0, 0)) +
  scale_fill_grey(name = "", 
                  labels = c("Present", 
                             "Missing")) +
  xlab("Observation") +
  theme(axis.text.y  = element_text(size = 4))

hours_worked_NA <- joined_data %>% 
  filter(is.na(`hours_worked`)) %>% 
  select(id,hours_worked, hourly_pay, employer_id, job_number)

library(visdat)

vis_miss(joined_data, cluster = TRUE)

library(caret)
library(recipes)

train_data_noid <- train_data %>% 
  dplyr::select(-id) %>% 
  dplyr::mutate(cohort = as_factor(cohort))

blueprint <- recipe(job_satisfaction_scaled ~ ., data = train_data_noid) %>%
  step_knnimpute(all_predictors(), neighbors = 6)

prepare <- prep(blueprint, training=train_data_noid)

baked_train <- bake(prepare, new_data = train_data_noid)

setwd("/Users/daisypacheco/Documents/GitHub/MLProject")
original_data_79 <- read_csv('data/paper/fulldata_79.csv')
library(tidyverse)
original_data_79 <- read_csv('data/paper/fulldata_79.csv')
names_dictionary_79 <- read.csv('data/paper/dictionary_79.csv', sep = ";")
cpi <- read_csv('data/paper/CPI.csv')
tidy_data_79 <- original_data_79 %>%
tidyr::pivot_longer(
-c(R0000100, R0214700, R0214800, R0010300, T4998600,
T4998601, T4998602, T4998603, T4998604, T4998605,
T4998606, T4998607, T4998608, T4998609, T5733900,
T5733901, T5733902, T5733903, T5733904, T5733905,
T5733906, T5733907, T5733908, T5733909),
names_to = "variable_id",
values_to = "value",
values_drop_na = TRUE
) %>%
dplyr::left_join(
names_dictionary_79
) %>%
dplyr::filter(value >= 0) %>%
dplyr::rename(
id = R0000100,
ethnicity = R0214700,
gender = R0214800,
religion = R0010300,
personality_14_1 = T4998600,
personality_14_2 = T4998601,
personality_14_3 = T4998602,
personality_14_4 = T4998603,
personality_14_5 = T4998604,
personality_14_6 = T4998605,
personality_14_7 = T4998606,
personality_14_8 = T4998607,
personality_14_9 = T4998608,
personality_14_10 = T4998609,
personality_16_1 = T5733900,
personality_16_2 = T5733901,
personality_16_3 = T5733902,
personality_16_4 = T5733903,
personality_16_5 = T5733904,
personality_16_6 = T5733905,
personality_16_7 = T5733906,
personality_16_8 = T5733907,
personality_16_9 = T5733908,
personality_16_10 =  T5733909
) %>%
dplyr::select(-variable_id, -religion,
-ethnicity, -gender)
yearly_variables_79 <- tidy_data_79 %>%
filter(is.na(job_number)) %>%
select(id, year, variable, value) %>%
mutate(row = row_number()) %>%
pivot_wider(
names_from = variable,
values_from = value
) %>%
select(id, year, age,
job_satisfaction_global) %>%
group_by(id, year) %>%
summarize_all(funs(mean(., na.rm = TRUE)))
View(tidy_data_79)
personality_79 <- tidy_data_79 %>%
select(id, starts_with("personality")) %>%
mutate(personality_1 = mean(personality_14_1, personality_16_1, na.rm = TRUE),
personality_2 = mean(personality_14_2, personality_16_2, na.rm = TRUE),
personality_3 = mean(personality_14_3, personality_16_3, na.rm = TRUE),
personality_4 = mean(personality_14_4, personality_16_4, na.rm = TRUE),
personality_5 = mean(personality_14_5, personality_16_5, na.rm = TRUE),
personality_6 = mean(personality_14_6, personality_16_6, na.rm = TRUE),
personality_7 = mean(personality_14_7, personality_16_7, na.rm = TRUE),
personality_8 = mean(personality_14_8, personality_16_8, na.rm = TRUE),
personality_9 = mean(personality_14_9, personality_16_9, na.rm = TRUE),
personality_10 = mean(personality_14_10, personality_16_10, na.rm = TRUE)) %>%
select(id, personality_1, personality_2, personality_3, personality_4,
personality_5, personality_6, personality_7, personality_8, personality_9,
personality_10)
View(tidy_data_79)
personality_79 <- tidy_data_79 %>%
select(id, starts_with("personality")) %>%
unique() %>%
rowwise() %>%
mutate(personality_1 = mean(personality_14_1, personality_16_1, na.rm = TRUE),
personality_2 = mean(personality_14_2, personality_16_2, na.rm = TRUE),
personality_3 = mean(personality_14_3, personality_16_3, na.rm = TRUE),
personality_4 = mean(personality_14_4, personality_16_4, na.rm = TRUE),
personality_5 = mean(personality_14_5, personality_16_5, na.rm = TRUE),
personality_6 = mean(personality_14_6, personality_16_6, na.rm = TRUE),
personality_7 = mean(personality_14_7, personality_16_7, na.rm = TRUE),
personality_8 = mean(personality_14_8, personality_16_8, na.rm = TRUE),
personality_9 = mean(personality_14_9, personality_16_9, na.rm = TRUE),
personality_10 = mean(personality_14_10, personality_16_10, na.rm = TRUE)) %>%
select(id, personality_1, personality_2, personality_3, personality_4,
personality_5, personality_6, personality_7, personality_8, personality_9,
personality_10)
View(personality_79)
View(personality_79)
tidy_data_fix_79 <- tidy_data_79 %>%
select(-starts_with("personality")) %>%
filter(!is.na(job_number)) %>%
left_join(yearly_variables_79)
View(tidy_data_fix_79)
columnar_data_79 <- tidy_data_fix_79 %>%
group_by(id, variable, job_number,
year, job_satisfaction_global, age) %>%
mutate(row = row_number()) %>%
pivot_wider(
names_from = variable,
values_from = value
) %>%
left_join(cpi) %>%
select(-row)
data_mutations_79 <- columnar_data_79 %>%
mutate(
job_satisfaction =
case_when(
currently_working == 1 & is.na(job_satisfaction) ~ job_satisfaction_global,
currently_working == 0 & is.na(job_satisfaction) ~ NA_real_,
currently_working == NA ~ NA_real_,
TRUE ~ job_satisfaction
)
) %>%
ungroup() %>%
select(-job_satisfaction_global) %>%
mutate(
job_satisfaction = dplyr::case_when(
job_satisfaction == 4 ~ 1,
job_satisfaction == 3 ~ 2,
job_satisfaction == 2 ~ 3,
job_satisfaction == 1 ~ 4,
TRUE ~ job_satisfaction
)
) %>%
mutate(
hourly_pay = log((hourly_pay * cpi) + 1),
tenure = tenure / 52,
avg_age_job_year = ((age - tenure) + age) / 2,
public = case_when(year <= 1993 & sector == 2 ~ 1,
year > 1993 & sector == 1 ~ 1,
TRUE ~ 0)
) %>%
filter(public == 1 &
!is.na(employer_id) &
!is.na(job_satisfaction)) %>%
select(id, year, job_number, employer_id,
job_satisfaction,
age, avg_age_job_year, tenure,
hours_worked_week, hourly_pay)
View(data_mutations_79)
mutations_with_personality_79 <- data_mutations_79 %>%
left_join(personality_79)
View(mutations_with_personality_79)
original_data_97 <- read_csv("data/paper/fulldata_97.csv")
names_dictionary_97 <- read.csv("data/paper/dictionary_97.csv", sep = ";")
tidy_data_97 <- original_data_97 %>%
tidyr::pivot_longer(
-c(R0000100, T3162500, T3162501, T3162502,
T3162503, T3162504, T3162505, T3162506,
T3162507, T3162508, T3162509),
names_to = "variable_id",
values_to = "value",
values_drop_na = TRUE
) %>%
dplyr::left_join(
names_dictionary_97
) %>%
dplyr::filter(value >= 0)  %>%
dplyr::rename(
id = R0000100,
personality_1 =	T3162500,
personality_2	= T3162501,
personality_3 = T3162502,
personality_4	= T3162503,
personality_5	= T3162504,
personality_6	= T3162505,
personality_7	= T3162506,
personality_8	= T3162507,
personality_9	= T3162508,
personality_10 = T3162509
) %>%
dplyr::select(-variable_id)
View(tidy_data_97)
View(names_dictionary_97)
View(tidy_data_79)
View(original_data_97)
yearly_variables_97 <- tidy_data_97 %>%
filter(is.na(job_number)) %>%
select(id, year, variable, value) %>%
mutate(row = row_number()) %>%
pivot_wider(
names_from = variable,
values_from = value
) %>%
select(-row) %>%
group_by(id, year) %>%
summarize_all(funs(mean(., na.rm = TRUE)))
View(yearly_variables_97)
library(tidyverse)
original_data_97 <- read_csv("data/paper/fulldata_97.csv")
names_dictionary_97 <- read.csv("data/paper/dictionary_97.csv", sep = ";")
cpi <- read_csv('data/paper/CPI.csv')
tidy_data_97 <- original_data_97
View(tidy_data_97)
